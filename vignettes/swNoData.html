<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>bayesImageS::swNoData(..)</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>bayesImageS::swNoData(..)</h1>

<p>This is the first in a series of posts describing the functions and algorithms that I have implemented in the <code>R</code> package <strong>bayesImageS</strong>.</p>

<p>Gibbs sampling was originally designed by Geman &amp; Geman (1984) for drawing updates from the Gibbs distribution, hence the name. However, single-site Gibbs sampling exhibits poor mixing due to the posterior correlation between the pixel labels. Thus it is very slow to converge when the correlation (controlled by the inverse temperature \( \beta \)) is high.</p>

<p>The algorithm of Swendsen &amp; Wang (1987) addresses this problem by forming clusters of neighbouring pixels, then updating all of the labels within a cluster to the same value. When simulating from the prior, such as a Potts model without an external field, this algorithm is very efficient.</p>

<p>The <code>SW</code> function in the <strong>PottsUtils</strong> package is implemented in a combination of <code>R</code> and <code>C</code>. The <code>swNoData</code> function in <strong>bayesImageS</strong> is implemented using <strong>RcppArmadillo</strong>, which gives it a speed advantage. It is worth noting that the intention of <strong>bayesImageS</strong> is not to replace <strong>PottsUtils</strong>. Rather, an efficient Swendsen-Wang algorithm is used as a building block for implementations of ABC (Grelaud et al., 2009), path sampling (Gelman &amp; Meng, 1998), and the exchange algorithm (Murray et al., 2006). These other algorithms will be covered in future posts.</p>

<p>There are two things that we want to keep track of in this simulation study: the speed of the algorithm and the distribution of the summary statistic. We will be using <code>system.time(..)</code> to measure both CPU and elapsed (wall clock) time taken for the same number of iterations, for a range of inverse temperatures:</p>

<pre><code class="r">beta &lt;- seq(0, 2, by = 0.1)
tmMx.PU &lt;- tmMx.bIS &lt;- matrix(nrow = length(beta), ncol = 2)
rownames(tmMx.PU) &lt;- rownames(tmMx.bIS) &lt;- beta
colnames(tmMx.PU) &lt;- colnames(tmMx.bIS) &lt;- c(&quot;user&quot;, &quot;elapsed&quot;)
</code></pre>

<p>We will discard the first 100 iterations as burn-in and keep the remaining 500.</p>

<pre><code class="r">iter &lt;- 600
burn &lt;- 100
samp.PU &lt;- samp.bIS &lt;- matrix(nrow = length(beta), ncol = iter - burn)
</code></pre>

<p>The distribution of pixel labels can be summarised by the sufficient statistic of the Potts model:</p>

<p>\( S(z) = \sum_{i \sim \ell \in \mathscr{N}} \delta(z_i, z_\ell)
 \)</p>

<p>where \( i \sim \ell \in \mathscr{N} \) are all of the pairs of neighbours in the lattice (ie. the cliques) and \( \delta(u,v) \) is 1 if \( u = v \) and 0 otherwise (the Kronecker delta function). <code>swNoData</code> returns this automatically, but with <code>SW</code> we will need to use the function <code>sufficientStat</code> to calculate the sufficient statistic for the labels.</p>

<pre><code class="r">library(bayesImageS)
</code></pre>

<pre><code>## Loading required package: Rcpp
</code></pre>

<pre><code>## Loading required package: RcppArmadillo
</code></pre>

<pre><code class="r">library(PottsUtils)

mask &lt;- matrix(1, 50, 50)
neigh &lt;- getNeighbors(mask, c(2, 2, 0, 0))
block &lt;- getBlocks(mask, 2)
edges &lt;- getEdges(mask, c(2, 2, 0, 0))

n &lt;- sum(mask)
k &lt;- 2
bcrit &lt;- log(1 + sqrt(k))
maxSS &lt;- nrow(edges)

for (i in 1:length(beta)) {
    # PottsUtils
    tm &lt;- system.time(result &lt;- SW(iter, n, k, edges, beta = beta[i]))
    tmMx.PU[i, &quot;user&quot;] &lt;- tm[&quot;user.self&quot;]
    tmMx.PU[i, &quot;elapsed&quot;] &lt;- tm[&quot;elapsed&quot;]
    res &lt;- sufficientStat(result, neigh, block, k)
    samp.PU[i, ] &lt;- res$sum[(burn + 1):iter]
    print(paste(&quot;PottsUtils::SW&quot;, beta[i], tm[&quot;elapsed&quot;], median(samp.PU[i, 
        ])))

    # bayesImageS
    tm &lt;- system.time(result &lt;- swNoData(beta[i], k, neigh, block, c(0, n), 
        iter))
    tmMx.bIS[i, &quot;user&quot;] &lt;- tm[&quot;user.self&quot;]
    tmMx.bIS[i, &quot;elapsed&quot;] &lt;- tm[&quot;elapsed&quot;]
    samp.bIS[i, ] &lt;- result$sum[(burn + 1):iter]
    print(paste(&quot;bayesImageS::swNoData&quot;, beta[i], tm[&quot;elapsed&quot;], median(samp.bIS[i, 
        ])))
}
</code></pre>

<pre><code>## [1] &quot;PottsUtils::SW 0 9.07 2454&quot;
## [1] &quot;bayesImageS::swNoData 0 0.27 2455&quot;
## [1] &quot;PottsUtils::SW 0.1 8.48 2575.5&quot;
## [1] &quot;bayesImageS::swNoData 0.1 0.390000000000001 2572&quot;
## [1] &quot;PottsUtils::SW 0.2 8.01 2699&quot;
## [1] &quot;bayesImageS::swNoData 0.2 0.43 2700&quot;
## [1] &quot;PottsUtils::SW 0.3 7.39 2832&quot;
## [1] &quot;bayesImageS::swNoData 0.3 0.439999999999998 2832.5&quot;
## [1] &quot;PottsUtils::SW 0.4 6.88 2980&quot;
## [1] &quot;bayesImageS::swNoData 0.4 0.43 2976&quot;
## [1] &quot;PottsUtils::SW 0.5 6.34 3130&quot;
## [1] &quot;bayesImageS::swNoData 0.5 0.43 3129&quot;
## [1] &quot;PottsUtils::SW 0.6 5.85 3311&quot;
## [1] &quot;bayesImageS::swNoData 0.6 0.450000000000003 3310&quot;
## [1] &quot;PottsUtils::SW 0.7 5.14 3515.5&quot;
## [1] &quot;bayesImageS::swNoData 0.7 0.410000000000004 3516.5&quot;
## [1] &quot;PottsUtils::SW 0.8 4.57 3787&quot;
## [1] &quot;bayesImageS::swNoData 0.8 0.409999999999997 3784&quot;
## [1] &quot;PottsUtils::SW 0.9 3.94999999999999 4177.5&quot;
## [1] &quot;bayesImageS::swNoData 0.9 0.420000000000002 4178&quot;
## [1] &quot;PottsUtils::SW 1 3.41 4516.5&quot;
## [1] &quot;bayesImageS::swNoData 1 0.420000000000002 4524.5&quot;
## [1] &quot;PottsUtils::SW 1.1 3.22999999999999 4672.5&quot;
## [1] &quot;bayesImageS::swNoData 1.1 0.420000000000002 4683&quot;
## [1] &quot;PottsUtils::SW 1.2 3.08 4763&quot;
## [1] &quot;bayesImageS::swNoData 1.2 0.390000000000001 4768&quot;
## [1] &quot;PottsUtils::SW 1.3 3.16 4812&quot;
## [1] &quot;bayesImageS::swNoData 1.3 0.420000000000002 4810&quot;
## [1] &quot;PottsUtils::SW 1.4 3.00999999999999 4842&quot;
## [1] &quot;bayesImageS::swNoData 1.4 0.390000000000001 4841&quot;
## [1] &quot;PottsUtils::SW 1.5 2.98 4862.5&quot;
## [1] &quot;bayesImageS::swNoData 1.5 0.400000000000006 4863&quot;
## [1] &quot;PottsUtils::SW 1.6 3.01000000000001 4876&quot;
## [1] &quot;bayesImageS::swNoData 1.6 0.399999999999991 4876&quot;
## [1] &quot;PottsUtils::SW 1.7 2.98999999999999 4884&quot;
## [1] &quot;bayesImageS::swNoData 1.7 0.390000000000001 4884&quot;
## [1] &quot;PottsUtils::SW 1.8 2.97999999999999 4888&quot;
## [1] &quot;bayesImageS::swNoData 1.8 0.400000000000006 4889&quot;
## [1] &quot;PottsUtils::SW 1.9 2.92999999999999 4893&quot;
## [1] &quot;bayesImageS::swNoData 1.9 0.399999999999991 4893&quot;
## [1] &quot;PottsUtils::SW 2 2.91 4896&quot;
## [1] &quot;bayesImageS::swNoData 2 0.38000000000001 4896&quot;
</code></pre>

<p>Here is the comparison of elapsed times between the two algorithms (in seconds):</p>

<pre><code class="r">summary(tmMx.PU)
</code></pre>

<pre><code>##       user         elapsed    
##  Min.   :2.92   Min.   :2.91  
##  1st Qu.:3.00   1st Qu.:3.01  
##  Median :3.37   Median :3.41  
##  Mean   :4.72   Mean   :4.73  
##  3rd Qu.:6.34   3rd Qu.:6.34  
##  Max.   :9.05   Max.   :9.07
</code></pre>

<pre><code class="r">summary(tmMx.bIS)
</code></pre>

<pre><code>##       user          elapsed     
##  Min.   :0.270   Min.   :0.270  
##  1st Qu.:0.390   1st Qu.:0.390  
##  Median :0.400   Median :0.410  
##  Mean   :0.404   Mean   :0.404  
##  3rd Qu.:0.430   3rd Qu.:0.420  
##  Max.   :0.450   Max.   :0.450
</code></pre>

<pre><code class="r">boxplot(tmMx.PU[, &quot;elapsed&quot;], tmMx.bIS[, &quot;elapsed&quot;], ylab = &quot;seconds elapsed&quot;, 
    names = c(&quot;SW&quot;, &quot;swNoData&quot;))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAilBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOTllOY9lZmVlj49ltf2POQCPOTmPOWWPj2WPtY+P2/21ZgC1Zjm1tWW124+1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v2lt3a/AAAALnRSTlP///////////////////////////////////////////////////////////8Ago9zVQAAAAlwSFlzAAALEgAACxIB0t1+/AAACwtJREFUeJzt3Yt62lYWhuEqnhqPm+C4kw52W0in0Kk56P5vr1vCcZ3JGrJ3tEBL+//eJ42dmCrL+XQCBPmuhaTvxh4A4yC8KMKLIrwowosivCjCiyK8KMKLIrwowosivCjCiyK8KMKLIrwowosivCjCiyK8KMKLIrwowosivCjCiyK8KMKLIrwowosivCjCiyK8KMKLIrwowosivCjCiyK8KMKLIrwowosivCjCiyK8KMKLIrwowosivCjCiyK8KMKLIrwowosivCjCiyK8KMKLIryoIeEbRHbG8AP+X5wb4UURXhThRRFeFOFFEV4U4UURXhThRRFeFOFFTSD8JZ+b0DGB8DH/uKkjvCjCiyK8qHrCowjhRRFeVD3hWc+KEF4U4UURXhThRdUTHkUIL4rwouoJz3pWhPCiCC+K8KIIL6qe8ChCeFGEF1VPeNazIoQXRXhRhBdFeFH1hEcRwosivKh6wrOeFSG8KMKLIrwowouqJzyKEF4U4UUNDr+7aWabprlaly7aG+tZkaHhD4/LdjNL/d8+FS7aG+GLDA2/v1+3m/nx46dFjvMmkoQvwhYvyuMYP+cYPz2c1YsivCjCi6onPOtZEcKLIrwowosivKh6wqMI4UURXlQ94VnPihBeFOFFEV4U4UXVEx5FCC+K8KLqCc96VoTwoggvivCiCC+qnvAoQnhRhBdVT3jWsyKEF0V4UYQXRXhR9YRHEcKLIryoesKznhUhvCjCiyK8KMKLqic8ihBeFOFF1ROe9awI4UURXhThRRFeVD3hUYTwoggvqp7wrGdFCC+K8KIIL4rwouoJjyKEF0V4UfWEZz0rQnhRhBc1avgm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" alt="plot of chunk unnamed-chunk-4"/> </p>

<p>On average, <code>swNoData</code> using <strong>RcppArmadillo</strong> is seven times faster than <code>SW</code>.</p>

<pre><code class="r">library(lattice)
s_z &lt;- c(samp.PU, samp.bIS)
s_x &lt;- rep(beta, times = iter - burn)
s_a &lt;- rep(1:2, each = length(beta) * (iter - burn))
s.frame &lt;- data.frame(s_z, c(s_x, s_x), s_a)
names(s.frame) &lt;- c(&quot;stat&quot;, &quot;beta&quot;, &quot;alg&quot;)
s.frame$alg &lt;- factor(s_a, labels = c(&quot;SW&quot;, &quot;swNoData&quot;))
xyplot(stat ~ beta | alg, data = s.frame)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/> </p>

<pre><code class="r">plot(c(s_x, s_x), s_z, pch = s_a, xlab = expression(beta), ylab = expression(S(z)))
abline(v = bcrit, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/> </p>

<p>The overlap between the two distributions is almost complete, although there is a statistically significant difference using a 2-way ANOVA:</p>

<pre><code class="r">s.frame$beta &lt;- factor(c(s_x, s_x))
s.fit &lt;- aov(stat ~ alg + beta, data = s.frame)
summary(s.fit)
</code></pre>

<pre><code>##                Df   Sum Sq  Mean Sq  F value Pr(&gt;F)    
## alg             1 5.14e+03 5.14e+03 4.24e+00   0.04 *  
## beta           20 1.74e+10 8.72e+08 7.18e+05 &lt;2e-16 ***
## Residuals   20978 2.55e+07 1.21e+03                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

<pre><code class="r">TukeyHSD(s.fit, which = &quot;alg&quot;)
</code></pre>

<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = stat ~ alg + beta, data = s.frame)
## 
## $alg
##               diff     lwr   upr  p adj
## swNoData-SW 0.9898 0.04714 1.932 0.0396
</code></pre>

<h3>References</h3>

<p>Gelman, A. &amp; Meng, X-L (1998) <a href="http://dx.doi.org/10.1214/ss/1028905934">Simulating normalizing constants: from importance sampling to bridge sampling to path sampling</a></p>

<p>Geman, S. and Geman, D. (1984) <a href="http://dx.doi.org/10.1109/TPAMI.1984.4767596">Stochastic relaxation, Gibbs distributions and the Bayesian restoration of images</a></p>

<p>Grelaud, A., Robert, C.P., Marin, J-M, Rodolphe, F. &amp; Taly, J-F (2009) <a href="http://dx.doi.org/10.1214/09-BA412">ABC likelihood-free methods for model choice in Gibbs random fields</a></p>

<p>Murray, I., Ghahramani, Z. &amp; MacKay, D.J.C. (2006) <a href="http://uai.sis.pitt.edu/displayArticleDetails.jsp?mmnu=1&amp;smnu=2&amp;article_id=1295&amp;proceeding_id=22">MCMC for Doubly-intractable Distributions</a></p>

<p>Swendsen, R.H. &amp; Wang, J-S (1987) <a href="http://dx.doi.org/10.1103/PhysRevLett.58.86">Nonuniversal critical dynamics in Monte Carlo simulations</a></p>

</body>

</html>

